"use strict";(()=>{var e={};e.id=708,e.ids=[708],e.modules={829:e=>{e.exports=require("jsonwebtoken")},2983:(e,r,s)=>{s.d(r,{A:()=>n});let t=require("mysql2/promise"),n=s.n(t)().createPool({host:process.env.DB_HOST,user:process.env.DB_USER,password:process.env.DB_PASSWORD,database:process.env.DB_NAME})},3480:(e,r,s)=>{e.exports=s(5600)},5486:e=>{e.exports=require("bcrypt")},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,s){return s in r?r[s]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,s)):"function"==typeof r&&"default"===s?r:void 0}}})},7830:(e,r,s)=>{s.r(r),s.d(r,{config:()=>P,default:()=>A,routeModule:()=>f});var t={};s.r(t),s.d(t,{default:()=>c});var n=s(3480),a=s(8667),o=s(6435),u=s(2983),i=s(5486),l=s.n(i),d=s(829),p=s.n(d);async function c(e,r){if("POST"!==e.method)return r.status(405).json({message:"Method Not Allowed"});let{name:s,email:t,password:n,role:a}=e.body;if(!s||!t||!n||!a)return r.status(400).json({message:"All fields are required."});try{let[e]=await u.A.query("SELECT * FROM users WHERE email = ?",[t]);if(e.length>0)return r.status(400).json({message:"User already exists."});let o=`${s.toLowerCase().replace(/\s/g,"")}_${Math.floor(1e3+9e3*Math.random())}`,i=await l().hash(n,10);await u.A.query("INSERT INTO users (empid, name, email, password, role) VALUES (?, ?, ?, ?, ?)",[o,s,t,i,a]);let d=p().sign({empid:o,name:s,email:t,role:a},process.env.JWT_SECRET,{expiresIn:"7d"});r.status(201).json({message:"User registered successfully!",token:d,user:{empid:o,name:s,email:t,role:a}})}catch(e){console.error("Signup Error:",e),r.status(500).json({message:"Internal Server Error"})}}let A=(0,o.M)(t,"default"),P=(0,o.M)(t,"config"),f=new n.PagesAPIRouteModule({definition:{kind:a.A.PAGES_API,page:"/api/auth/signup",pathname:"/api/auth/signup",bundlePath:"",filename:""},userland:t})},8667:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return s}});var s=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var r=require("../../../webpack-api-runtime.js");r.C(e);var s=r(r.s=7830);module.exports=s})();